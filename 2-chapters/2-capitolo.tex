\chapter{Titolo del secondo capitolo}
\label{chap:cap2}

Le assunzioni secondo cui ogni individuo possa entrare in contatto con chiunque (mixing omogeneo) e il numero di interazioni di ciascun soggetto sia confrontabile con quello degli altri non sono realistiche: anzi, la probabilità che si verifichi un incontro fra due individui presi a caso è praticamente infinitesima. Di norma, ognuno ha una serie di contatti regolari con un numero ristretto di persone (familiari, colleghi, etc), mentre ignora tutto il resto della popolazione; questo li rende particolarmente adatti ad essere rappresentati tramite una rete.
\medskip 
Andiamo ad introdurre una serie di definizioni che in seguito ci risulteranno utili. \\
\begin{definizione}[\textit{Grafo}]
Un \emph{grafo} (o una \emph{rete}) è un insieme di elementi detti vertici o \emph{nodi} che possono essere collegati fra loro da segmenti detti archi o \emph{link}.
\end{definizione}
\begin{figure}
		\begin{center}
			\includegraphics[scale=.8, keepaspectratio]{network_example}
			\caption{(a) Un grafo semplice, cioè privo di loop o link multipli. (b) Un grafo che presenta entrambi. \cite{Newman}}
			\label{fig:net_ex}
		\end{center}
	\end{figure}
	
Consideriamo una rete non orientata - cioè una rete in cui i link possono essere percorsi indistintamente in un verso e nell'altro - con $ n $ vertici, che andiamo ad etichettare da $ 1 $ a $ n $. Se indichiamo con $ \left( i, j \right) $ l'arco fra i nodi $ i $ e $ j $, allora l'intera rete può essere descritta in funzione della
\begin{definizione}[\textit{Matrice di adiacenza I}]
La matrice di adiacenza \textbf{A} relativa ad un grafo semplice è una matrice i cui elementi sono così definiti:
\[
A_{ij} \, =
\begin{cases}
1, & \text{se esiste un arco fra $ i $ e $ j $}\\ 
0, & \text{altrimenti}
\end{cases}
\]
\end{definizione}
Se dunque prendiamo, ad esempio, la rete (a) in \cref{fig:net_ex}, assumerà la seguente forma:
\begin{equation}
A =
\begin{pmatrix}
0 & 1 & 0 & 0 & 1 & 0 \\
1 & 0 & 1 & 1 & 0 & 0 \\
0 & 1 & 0 & 1 & 1 & 1 \\
0 & 1 & 1 & 0 & 0 & 0 \\
1 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0
\end{pmatrix}
\end{equation}
Possiamo osservare che risulta essere una matrice simmetrica con tutti $ 0 $ sulla diagonale. 
\\Qualora invece ne avessimo sotto esame una più simile alla (b) della medesima figura, dovremmo tener conto del fatto che sono presenti link multipli e loop; si stabilisce di assegnare ai primi un numero pari alla loro molteplicità e ai secondi il valore $ 2 $, così che
\begin{equation}
A =
\begin{pmatrix}
0 & 1 & 0 & 0 & 3 & 0 \\
1 & 2 & 2 & 1 & 0 & 0 \\
0 & 2 & 0 & 1 & 1 & 1 \\
0 & 1 & 1 & 0 & 0 & 0 \\
3 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 2
\end{pmatrix}
\end{equation}
matrice che rimane, ad ogni modo, simmetrica.

\begin{wrapfigure}{l}{0.4\textwidth}
		\includegraphics[width=0.38\textwidth]{digraph_example}
		\caption{Un digrafo. \cite{Newman}}
		\label{fig:dig_ex}
\end{wrapfigure}

La questione cambia leggermente se si va a considerare una rete diretta o \emph{digrafo}.
\begin{definizione}[\textit{Digrafo}]
Un \emph{digrafo} è un tipo di grafo in cui ogni arco ha una direzione, punta cioè da un vertice ad un altro.
\end{definizione}
Ciò ci porta a rivedere quanto detto per la matrice di adiacenza: affermiamo, quindi, che
\begin{definizione}[\textit{Matrice di adiacenza II}]
La matrice di adiacenza \textbf{A} relativa ad un grafo orientato è una matrice i cui elementi sono così definiti:
\[
A_{ij} \, =
\begin{cases}
1, & \text{se esiste un arco da $ j $ a $ i $}\\ 
0, & \text{altrimenti}
\end{cases}
\]
\end{definizione}

Relativamente alla \cref{fig:dig_ex}, si avrà pertanto \\
\begin{equation}
A =
\begin{pmatrix}
0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
1 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 \\
0 & 0 & 0 & 1 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 0
\end{pmatrix}
\end{equation}
\\
Ci soffermiamo poi su un particolare tipo di grafo, che ci risulterà più utile in seguito.
\begin{definizione}[\textit{Grafo bipartito}] \cite{Bondy}
Un grafo si dice \emph{bipartito} se i suoi vertici possono essere suddivisi in due sottoinsiemi X e Y tali che ogni link ha un'estremità in X ed una in Y. 
\end{definizione}
%\begin{figure}[h]
%	\begin{center}
%		\includegraphics[scale=1]{bipartite_graph}
%		\caption{Un grafo bipartito \emph{completo}, in cui ogni vertice del gruppo X è connesso a tutti quelli del gruppo Y.}
%		\label{fig:bip_graph}
%	\end{center}
%\end{figure}
In modo del tutto equivalente a quanto abbiamo già fatto, possiamo andare a definire per un grafo siffatto una matrice che lo va a descrivere.
\begin{definizione}[\textit{Matrice di incidenza}]
La matrice di incidenza \textbf{B} è una matrice $ g x n $, dove $ g $ è il numero di sottoinsiemi e $ n $ quello dei vertici che ne fanno parte, i cui elementi sono definiti come segue:
\[
B_{ij} \, =
\begin{cases}
1, & \text{se il vertice $ j $ appartiene al gruppo $ i $ }\\
0, & \text{altrimenti}
\end{cases}
\]
\end{definizione}

\begin{wrapfigure}{r}{0.7\textwidth}
	\begin{center}
		\includegraphics[width=0.35\textwidth]{projections}
	\end{center}
	\caption{
%	In figura si mette in luce il passaggio da una rappresentazione tipica di una rete bipartito ad una in cui compaiono solo i vertici. 
	\cite{Newman}}
	\label{fig:projs}
\end{wrapfigure}
	Uno dei pregi di una rete bipartita è quello di consentire in modo fluido il passaggio da una rappresentazione in cui compaiono sia vertici che gruppi ad una in cui figurano, ad esempio, soltanto i vertici; questa possibilità permette di visualizzare il formarsi di quelle che prendono il nome di cricche (\emph{cliques}).
\begin{definizione}[\textit{Cricca}] \cite{Bickle}
Una \emph{cricca} è un sottografo completo, cioè un sottografo in cui ogni vertice è connesso a tutti gli altri.
\end{definizione}
L'emergere di questi raggruppamenti, di conseguenza, mette in rilievo l'esistenza di gruppi fortemente coesi all'interno della rete; questo aspetto assume ulteriore valore, in particolare, quando cerchiamo di rispondere ad una domanda che ci siamo posti nel precedente capitolo, ovvero come poter rappresentare una popolazione nella quale stia prendendo piede un certo tipo di malattia infettiva, perché ci consente non solo di dare forma agli individui che la costituiscono, ma anche all'intensità dei legami che intercorrono fra di essi: ci aspettiamo, infatti, che membri di una famiglia o colleghi di lavoro vadano a costituire una cricca. \\
\begin{definizione}[\textit{Grado di un vertice}]
Diciamo \emph{grado} di un vertice il numero di archi ad esso connessi.
\end{definizione}
Se abbiamo un grafo non orientato con $ n $ vertici, possiamo esprimere il grado dell'i-esimo vertice come
\begin{equation}
	k_i = \sum_{j=1}^n A_{ij}
\end{equation}
Osserviamo adesso che, se una rete consta di $ m $ link, il numero totale di estremità che possiamo contare - pari a $ 2m $ - altro non è se non la somma dei gradi di tutti i vertici: 
\begin{equation}
	m = \frac{1}{2} \sum_{i=1}^n k_i
\end{equation}
il che ci porta ad esprimere il grado \emph{medio} di un vertice come 
\begin{equation}
 	c = \frac{1}{2} \sum_{i=1}^n k_i = \frac{2m}{n} 
\end{equation}
 \\Indichiamo poi la \emph{densità} di un grafo semplice come la frazione di archi effettivamente presenti:
\begin{equation}
	\rho = \frac{m}{\binom{n}{k}} = \frac{2m}{n\left(n-1 \right)} = \frac{c}{n-1}
\end{equation}
con $ 0 \leq \rho \leq  1 $ e  $ \binom{n}{k} $  numero massimo di link che è possibile tracciare. \\Ci soffermiamo brevemente sulle stesse grandezze nel caso in cui si stia esaminando una rete orientata:
\begin{itemize}
\item si può distinguere fra il grado esterno (relativo agli archi uscenti da un vertice)
	\begin{equation}
		k_{i}^{out} = \sum_{j=1}^n A_{ij}	
	\end{equation}
e quello interno (relativo agli archi entranti)
	\begin{equation}
		k_{j}^{in} = \sum_{i=1}^n A_{ij}
	\end{equation}
\item il numero di link presenti è pari a
	\begin{equation}
		m = \sum_{i=1}^n k_i^{in} = \sum_{j=1}^n k_j^{out} = \sum_{ij} A_{ij}
	\end{equation}
\item il grado medio esterno è equivalente a quello interno
	\begin{equation}
		c^{in} = \frac{1}{n} \sum_{i=1}^n k_i^{in} = \frac{1}{n} \sum_{j=1}^n k_j^{out} = c^{out}
	\end{equation}
\end{itemize}


Il concetto di grado ci è immediatamente utile per definirne un altro: quello di \emph{assortatività} o di \emph{mixing assortativo}.
% o meglio scriverli in inglese?
 Con questo termine indichiamo una tendenza, da parte dei vertici, a legarsi con altri nodi che, in qualche modo, somigliano loro; è piuttosto immediato pensare che un aspetto che possono avere in comune sia proprio il grado e, in effetti, in questo contesto si parla di mixing assortativo per grado: è possibile andarlo a quantificare mediante un coefficiente \cite{Newman}
\begin{equation}
	r = \frac{ \sum_{ij} \left( A_{ij} - \frac{k_i k_j}{2m} \right) k_i k_j}{\sum_{ij} \left(k_i \delta_{ij} - \frac{k_i k_j}{2m} \right) k_i k_j}
\end{equation}